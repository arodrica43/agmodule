<style>
.dvt-container{
    position: relative;
}
.dvt-container > div{
        font-size: 30px;
        padding: .5em;
        margin: .5em;
        text-align: center;
        width:100%;
        font-size:calc(1rem + 1.2vw);
}
.dvt-container > div > img{
        width: 25%;
        height: 25%;
        -webkit-transition: .15s;
        transition: .15s; 
    }

.dvt-container > div > div > img{
        width: 12%;
        height: 12%;
        cursor: pointer;
        -webkit-transition: .15s;
        transition: .15s; 
    }

.dvt-container > div > div > img:hover{
     -webkit-transform: scale(1.3); 
      transform: scale(1.3);
  }
</style>


<div id = "dvt-widget-dynamic_index" class="dvt-container"></div>
<param id = "dvt-widget-handshake-dynamic_index" value=0></param> 

<script>
document.querySelector("#dvt-widget-handshake-dynamic_index").value = 1;

function render_dvt(modifiable){
	document.querySelector("#dvt-widget-dynamic_index").innerHTML = '<div>Change the icon of ' + modifiable.title + '</div>' + 
																	'<div><img id="main-badge-dynamic_index" src="' + modifiable.icon + '"><br>' +
																	'<br><div><img class="selectable-image" src="https://agmodule.herokuapp.com/media/badge_icons/b1.svg" onclick="changeIcon(1,' + modifiable.id + ');">' +
																	'<img class="selectable-image" src="https://agmodule.herokuapp.com/media/badge_icons/b2.svg" onclick="changeIcon(2,' + modifiable.id + ');">' +
																	'<img class="selectable-image" src="https://agmodule.herokuapp.com/media/badge_icons/b3.svg" onclick="changeIcon(3,' + modifiable.id + ');">' +
																	'<img class="selectable-image" src="https://agmodule.herokuapp.com/media/badge_icons/b4.svg" onclick="changeIcon(4,' + modifiable.id + ');">' +
																	'<img class="selectable-image" src="https://agmodule.herokuapp.com/media/badge_icons/b5.svg" onclick="changeIcon(5,' + modifiable.id + ');"></div></div>';
}

function selectPolicy(list){
	return list[Math.floor(Math.random() * list.length)];
}

function changeIcon(type, id){
    document.querySelector("#main-badge-dynamic_index").src = "https://agmodule.herokuapp.com/media/badge_icons/b" + type + ".svg"
    fetch("https://agmodule.herokuapp.com/api/badges/" + id + "/change_icon?option=" + type)
	.then(response => response.json())
	.then(res_json => (alert("Badge icon changed!")))
	.catch(error => (console.log("Error: " + error)))

}

modifiables = ["badges"]
mod_type =  modifiables[Math.floor(Math.random() * modifiables.length)];

url = "https://agmodule.herokuapp.com/api/" + mod_type + "/";
fetch(url)
.then(response => response.json())
.then(res_json => (res_json.results))
.then((list) => (selectPolicy(list)))
.then((modifiable) => ( console.log(modifiable), render_dvt(modifiable)))
.catch(error => (console.log("Error: " + error)))

</script>