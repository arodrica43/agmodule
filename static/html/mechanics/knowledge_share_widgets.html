<head>
<!-- Font Awesome Icon Library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<style>
.ksh-container{
    position: relative;
	top:-12px;
}
.ksh-container > div{
        padding: 1.5em;
        padding-left: .5em;
        padding-right:.5em;
        padding-bottom:0;
        margin: .5em;
        text-align: center;
        width:100%;
        font-size:calc(1.5em + 1.5vw);
}
.ksh-container > div > img{
        width: 25%;
        height: 25%;
        -webkit-transition: .15s;
        transition: .15s; 
    }
</style>

<div id = "ksh-widget-dynamic_index" class="ksh-container"></div>
<param id = "ksh-widget-handshake-dynamic_index" value=0></param> 

<script>
	//INTERACTION INIT -----------------------------------------------------------------------
    //Dynamic property :: Log tracking functions
    include-base-tracking
    include-onclick-tracking
    start_main_time();
    start_focus_time("ksh-widget-dynamic_index");
    start_logs(log,"dynamic_user", "dynamic_mechanic_index",16);
    set_widget_defaults("#ksh-widget-dynamic_index", "dynamic_mechanic_index", "dynamic_link_url");
    // ---------------------------------------------------------------------------------------

document.querySelector("#ksh-widget-handshake-dynamic_index").value = 1;

  
function log_txt_click_dynamic_index(){
          // INTERACTION OCCURRENCE REGISTRATION --------------------------------------
          //Logging :: button-click interaction
          log_click({itime: 10, message:"Title text clicked", register : log, level:1,type:"TextClick"});
           // --------------------------------------------------------------------------
          };

function log_img_click_dynamic_index(){
          // INTERACTION OCCURRENCE REGISTRATION --------------------------------------
          //Logging :: button-click interaction
          log_click({itime: 10, message:"Main icon clicked", register : log, level:1,type:"ImageClick"});
           // --------------------------------------------------------------------------
          };

function log_inp_focus_dynamic_index(){
          // INTERACTION OCCURRENCE REGISTRATION --------------------------------------
          //Logging :: button-click interaction
          log_click({itime: 10, message:"Text input focused", register : log, level:1,type:"FocusIn"});
           // --------------------------------------------------------------------------
          };

function send_tip(tip){
     // INTERACTION OCCURRENCE REGISTRATION --------------------------------------
    //Logging :: button-click interaction
    log_click({itime: 10, message:"Send tip button clicked", register : log, level:1,type:"ButtonClick"});
	if(document.getElementById("tip-input-dynamic_index").value == ""){
		alert("Your tip is empty!");
	}else{
			fetch("https://agmodule.herokuapp.com/api/gift_to_all?from=dynamic_user&type=text&content=" + document.getElementById("tip-input-dynamic_index").value)
		.then(response => response.json())
		.then(res_json => (console.log(res_json), alert("Tip sent!")))
		.catch(error => (console.log("Error: " + error)));
		tip.disabled = true;
	}
}

function render_ksh(){
	document.querySelector("#ksh-widget-dynamic_index").innerHTML += "<div><p onclick='log_txt_click_dynamic_index();'>Let's help each other</p><img onclick='log_img_click_dynamic_index();' src='https://agmodule.herokuapp.com/media/philantropy_icons/send_tip.svg'><br><div style='height:10px;'></div><input onfocus='log_inp_focus_dynamic_index();' style='width:50%' type='text' id='tip-input-dynamic_index' value=''><br><button class='btn btn-light' onclick='send_tip(this)'>Send a tip to everyone!</button></div>";
}

render_ksh();
</script>